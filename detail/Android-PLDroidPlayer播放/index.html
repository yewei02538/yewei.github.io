<!DOCTYPE html>
<html>
    <head>
    <!-- Title -->
    
    <title>
        Android 使用PLDroidPlayer播放网络视频 根据视频角度自动旋转 | Wey Ye的博客
    </title>
    
    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/favicon.ico">
    <link rel="icon" sizes="192x192" href="/favicon.png">
    <link rel="apple-touch-icon" href="/favicon.png">
    
    <!-- Meta & INfo -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Wey Ye">
    <meta name="description" content="null">
    <meta name="keywords" content="android,个人技术博客,移动开发,google">
    
    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">
    
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Wey Ye的博客">
    
    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://weyye.me">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Android 使用PLDroidPlayer播放网络视频 根据视频角度自动旋转 | Wey Ye的博客">
    <meta property="og:description" content="null">
    
     <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">
        
        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->
    
    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
	body, html{
		font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
	}
	
    a{
        color: #00838F
    }
    
    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #0097A7 !important
    }
    
	/* Sidebar User Drop Down Menu Text Color */
	#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus{
        color: #0097A7 !important
    }
    
    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a{
        color: #0097A7 !important
    }
    
    .toTop{
        background: #757575 !important
    }
		
	.material-layout .material-post>.material-nav,
	.material-layout .material-index>.material-nav,
	.material-nav a{
		color: #757575;
	}
		
	#scheme-Paradox .MD-burger-layer {
		background-color: #757575;
	}

	#scheme-Paradox #post-toc-trigger-btn{
		color: #757575;
	}
	
	.post-toc a:hover{
		color: #00838F;
		text-decoration: underline;
	}
</style>


<!-- Theme Background Related-->

    <style>
        body{
            background-color: #F5F5F5
        }
		
		/* blog_info bottom background */
        #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
            background-color: #fff;
        }
    </style>




<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>

	<script src="/js/jquery.min.js"></script>
	
	<link rel="stylesheet" href="/css/highlight/solarized-white.css">
	
	<!-- UC Browser Compatible-->
	<script>
		var agent = navigator.userAgent.toLowerCase();
		if(agent.indexOf('ucbrowser')>0) {
			document.write('<link rel="stylesheet" href="/css/uc.css">');
		   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
		}
	</script>
    
    <!-- Custom Head -->
    
        
			<!-- baidu_analytics -->
			<script> var _hmt = _hmt || []; (function() { var hm = document.createElement('script'); hm.src = 'https://hm.baidu.com/hm.js?b7e5f6ac58c952eaf3e7b49fb65496f8'; var s = document.getElementsByTagName('script')[0];  s.parentNode.insertBefore(hm, s); })(); </script>
        
    
<link rel="stylesheet" href="/css/prism-okaidia.css" type="text/css"></head>
	
	

    <body id="scheme-Paradox">

		
        <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
				
			
			
            <!-- Main Container -->
            <main class="material-layout__content" id="main">
				
                <!-- Top Anchor -->
                <div id="top"></div>
				
				
                <!-- Hamburger Button -->
                <button class="MD-burger-icon sidebar-toggle">
                    <span class="MD-burger-layer"></span>
                </button>
				
				
                <!-- Post TOC -->

    
	<!-- Back Button -->
<!--
	<div class="material-back" id="backhome-div" tabindex="0">
		<a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" href="#" onclick="window.history.back();return false;" target="_self" role="button" data-upgraded=",MaterialButton,MaterialRipple">
			<i class="material-icons" role="presentation">arrow_back</i>
			<span class="mdl-button__ripple-container">
				<span class="mdl-ripple"></span>
			</span>
		</a>
	</div>			
-->
	<!-- Left aligned menu below button -->
	<button id="post-toc-trigger-btn"
			class="mdl-button mdl-js-button mdl-button--icon">
	  <i class="material-icons">format_list_numbered</i>
	</button>

	<ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect"
		for="post-toc-trigger-btn">
			
			
		
<!--			<li class="mdl-menu__item">Some Action</li>-->
	</ul>



<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">
		
        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
	<!-- Paradox Post Header -->
	
		
			<!-- Random Thumbnail -->
			<div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
				<script>
    
    var randomNum;
    randomNum = Math.floor(Math.random() * 5 + 1);
    
    $(".post_thumbnail-random").css('background-image', 'url(' + '/img/random/' + randomNum + '.png' + ')');
    
</script>

		
	
        <p class="article-headline-p">
            Android 使用PLDroidPlayer播放网络视频 根据视频角度自动旋转
        </p>
    </div>

	

				
				
					<!-- Paradox Post Info -->
					<div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">
    
    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Wey Ye</strong>
        <span>7月 20, 2016</span>
    </div>
    
    <div class="section-spacer"></div>
	
    <!-- Favorite -->
<!--
    <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
        <i class="material-icons" role="presentation">favorite</i>
        <span class="visuallyhidden">favorites</span>
    </button>
-->

    <!-- Qrcode -->
    


    <!-- Tags (bookmark) -->
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        
    </ul>
    
    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">

    
    <!-- Leancloud Views -->
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span id="/detail/Android-PLDroidPlayer播放/" class="leancloud-views_num" data-flag-title="Android 使用PLDroidPlayer播放网络视频 根据视频角度自动旋转">
     &nbsp;浏览量
</span>
        </li>
    </a>
    

    

    <!-- Share Twitter -->
    <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Android 使用PLDroidPlayer播放网络视频 根据视频角度自动旋转&url=http://weyye.me//detail/Android-PLDroidPlayer播放/index.html&via=Wey Ye" target="_blank">
        <li class="mdl-menu__item">
            分享到 Twitter
        </li>
    </a>

    <!-- Share Google+ -->
    <a class="post_share-link" href="https://plus.google.com/share?url=http://weyye.me//detail/Android-PLDroidPlayer播放/index.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 Google+
        </li>
    </a>

    <!-- Share Weibo -->
    <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Android 使用PLDroidPlayer播放网络视频 根据视频角度自动旋转&url=http://weyye.me//detail/Android-PLDroidPlayer播放/index.html&pic=&searchPic=false&style=simple" target="_blank">
        <li class="mdl-menu__item">
            分享到微博
        </li>
    </a>

    <!-- Share LinkedIn -->
    <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=http://weyye.me//detail/Android-PLDroidPlayer播放/index.html&title=Android 使用PLDroidPlayer播放网络视频 根据视频角度自动旋转" target="_blank">
        <li class="mdl-menu__item">
            分享到 LinkedIn
        </li>
    </a>

    <!-- Share QQ -->
    <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=Wey Ye的博客&title=Android 使用PLDroidPlayer播放网络视频 根据视频角度自动旋转&summary=null&pics=http://weyye.me/favicon.ico&url=http://weyye.me/detail/Android-PLDroidPlayer播放/index.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 QQ
        </li>
    </a>

    <!-- Share Telegram -->
    <a class="post_share-link" href="https://telegram.me/share/url?url=http://weyye.me/detail/Android-PLDroidPlayer播放/index.html&text=Android 使用PLDroidPlayer播放网络视频 根据视频角度自动旋转" target="_blank">
        <li class="mdl-menu__item">
            分享到 Telegram
        </li>
    </a>
</ul>

</div>
				

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
	
		<p>最近因为项目需求 ，需要播放网络视频  ，于是乎 研究了一番 ，说说我遇到的那些坑    </p>
<p>现在市面上有几个比较主流好用的第三方框架</p>
<ul>
<li>Vitamio （  体积比较大，有商业化风险 github:<a href="https://github.com/yixia/VitamioBundle/）" target="_blank" rel="external">https://github.com/yixia/VitamioBundle/）</a></li>
<li>ijkplayer（B站下开源的框架 体积大 配置环境比较麻烦  github:<a href="https://github.com/Bilibili/ijkplayer" target="_blank" rel="external">https://github.com/Bilibili/ijkplayer</a> ）</li>
<li>PLDroidPlayer（七牛根据ijkplayer二次开发的 定制简单 github:<a href="https://github.com/pili-engineering/PLDroidPlayer）" target="_blank" rel="external">https://github.com/pili-engineering/PLDroidPlayer）</a><a id="more"></a>
当然还有很多别的视频播放框架 因为我只找到这几个= =！</li>
</ul>
<p>因为项目比较急，所以我用的比较简单的 PLDroidPlayer</p>
<p> 首先把需要的jar包和jni文件拷到你的项目中<br>这个里面有很多控件，你们可以根据自己的需求来用指定的控件，我用的是PLVideoTextureView</p>
<pre class=" language-python"><code class="language-python"><span class="token operator">&lt;</span>com<span class="token punctuation">.</span>pili<span class="token punctuation">.</span>pldroid<span class="token punctuation">.</span>player<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>PLVideoTextureView
        android<span class="token punctuation">:</span>id<span class="token operator">=</span><span class="token string">"@+id/video"</span>
        android<span class="token punctuation">:</span>layout_width<span class="token operator">=</span><span class="token string">"match_parent"</span>
        android<span class="token punctuation">:</span>layout_height<span class="token operator">=</span><span class="token string">"match_parent"</span>
        android<span class="token punctuation">:</span>layout_centerInParent<span class="token operator">=</span><span class="token string">"true"</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> prompt<span class="token string">''</span>'
</code></pre>
<p>然后findviewbyid找到它</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PLVideoTextureActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> MediaController mMediaController<span class="token punctuation">;</span>
    <span class="token keyword">private</span> PLVideoTextureView mVideoView<span class="token punctuation">;</span>
    <span class="token keyword">private</span> Toast mToast <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String mVideoPath <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> mRotation <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> mDisplayAspectRatio <span class="token operator">=</span> PLVideoTextureView<span class="token punctuation">.</span>ASPECT_RATIO_FIT_PARENT<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//default</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>Bundle savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">getWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addFlags</span><span class="token punctuation">(</span>WindowManager<span class="token punctuation">.</span>LayoutParams<span class="token punctuation">.</span>FLAG_KEEP_SCREEN_ON<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_pl_video_texture<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVideoView <span class="token operator">=</span> <span class="token punctuation">(</span>PLVideoTextureView<span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>VideoView<span class="token punctuation">)</span><span class="token punctuation">;</span>

        View loadingView <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>LoadingView<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">setBufferingIndicator</span><span class="token punctuation">(</span>loadingView<span class="token punctuation">)</span><span class="token punctuation">;</span>

        mVideoPath <span class="token operator">=</span> <span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">"videoPath"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// If you want to fix display orientation such as landscape, you can use the code show as follow</span>
        <span class="token comment" spellcheck="true">//</span>
        <span class="token comment" spellcheck="true">// if (this.getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE) {</span>
        <span class="token comment" spellcheck="true">//     mVideoView.setPreviewOrientation(0);</span>
        <span class="token comment" spellcheck="true">// }</span>
        <span class="token comment" spellcheck="true">// else if (this.getResources().getConfiguration().orientation == Configuration.ORIENTATION_PORTRAIT) {</span>
        <span class="token comment" spellcheck="true">//     mVideoView.setPreviewOrientation(270);</span>
        <span class="token comment" spellcheck="true">// }</span>

        mVideoPath <span class="token operator">=</span> <span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">"videoPath"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        AVOptions options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AVOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> isLiveStreaming <span class="token operator">=</span> <span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getIntExtra</span><span class="token punctuation">(</span><span class="token string">"liveStreaming"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// the unit of timeout is ms</span>
        options<span class="token punctuation">.</span><span class="token function">setInteger</span><span class="token punctuation">(</span>AVOptions<span class="token punctuation">.</span>KEY_PREPARE_TIMEOUT<span class="token punctuation">,</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        options<span class="token punctuation">.</span><span class="token function">setInteger</span><span class="token punctuation">(</span>AVOptions<span class="token punctuation">.</span>KEY_GET_AV_FRAME_TIMEOUT<span class="token punctuation">,</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// Some optimization with buffering mechanism when be set to 1</span>
        options<span class="token punctuation">.</span><span class="token function">setInteger</span><span class="token punctuation">(</span>AVOptions<span class="token punctuation">.</span>KEY_LIVE_STREAMING<span class="token punctuation">,</span> isLiveStreaming<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isLiveStreaming <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            options<span class="token punctuation">.</span><span class="token function">setInteger</span><span class="token punctuation">(</span>AVOptions<span class="token punctuation">.</span>KEY_DELAY_OPTIMIZATION<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment" spellcheck="true">// 1 -> hw codec enable, 0 -> disable [recommended]</span>
        <span class="token keyword">int</span> codec <span class="token operator">=</span> <span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getIntExtra</span><span class="token punctuation">(</span><span class="token string">"mediaCodec"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        options<span class="token punctuation">.</span><span class="token function">setInteger</span><span class="token punctuation">(</span>AVOptions<span class="token punctuation">.</span>KEY_MEDIACODEC<span class="token punctuation">,</span> codec<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// whether start play automatically after prepared, default value is 1</span>
        options<span class="token punctuation">.</span><span class="token function">setInteger</span><span class="token punctuation">(</span>AVOptions<span class="token punctuation">.</span>KEY_START_ON_PREPARED<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        mVideoView<span class="token punctuation">.</span><span class="token function">setAVOptions</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// You can mirror the display</span>
        <span class="token comment" spellcheck="true">// mVideoView.setMirror(true);</span>

        <span class="token comment" spellcheck="true">// You can also use a custom `MediaController` widget</span>
        mMediaController <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MediaController</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> isLiveStreaming <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">setMediaController</span><span class="token punctuation">(</span>mMediaController<span class="token punctuation">)</span><span class="token punctuation">;</span>

        mVideoView<span class="token punctuation">.</span><span class="token function">setOnInfoListener</span><span class="token punctuation">(</span>mOnInfoListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//        mVideoView.setOnVideoSizeChangedListener(mOnVideoSizeChangedListener);</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">setOnBufferingUpdateListener</span><span class="token punctuation">(</span>mOnBufferingUpdateListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">setOnCompletionListener</span><span class="token punctuation">(</span>mOnCompletionListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">setOnSeekCompleteListener</span><span class="token punctuation">(</span>mOnSeekCompleteListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">setOnErrorListener</span><span class="token punctuation">(</span>mOnErrorListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">setVideoPath</span><span class="token punctuation">(</span>mVideoPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">setDisplayAspectRatio</span><span class="token punctuation">(</span>PLVideoView<span class="token punctuation">.</span>ASPECT_RATIO_PAVED_PARENT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">setOnPreparedListener</span><span class="token punctuation">(</span>mOnPreparedListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">setOnVideoSizeChangedListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PLMediaPlayer<span class="token punctuation">.</span>OnVideoSizeChangedListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onVideoSizeChanged</span><span class="token punctuation">(</span>PLMediaPlayer plMediaPlayer<span class="token punctuation">,</span> <span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                Logger<span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">"width:"</span> <span class="token operator">+</span> width <span class="token operator">+</span> <span class="token string">"---heightL:"</span> <span class="token operator">+</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>width <span class="token operator">></span> height<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">//视频是横屏 旋转方向</span>
                   <span class="token function">setRequestedOrientation</span><span class="token punctuation">(</span>ActivityInfo<span class="token punctuation">.</span>SCREEN_ORIENTATION_LANDSCAPE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>


            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        mVideoView<span class="token punctuation">.</span><span class="token function">setVideoPath</span><span class="token punctuation">(</span>mVideoPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onPause</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onPause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mToast <span class="token operator">=</span> null<span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onResume</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onResume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">stopPlayback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClickRotate</span><span class="token punctuation">(</span>View v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mRotation <span class="token operator">=</span> <span class="token punctuation">(</span>mRotation <span class="token operator">+</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">360</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">setDisplayOrientation</span><span class="token punctuation">(</span>mRotation<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClickSwitchScreen</span><span class="token punctuation">(</span>View v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mDisplayAspectRatio <span class="token operator">=</span> <span class="token punctuation">(</span>mDisplayAspectRatio <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">;</span>
        mVideoView<span class="token punctuation">.</span><span class="token function">setDisplayAspectRatio</span><span class="token punctuation">(</span>mDisplayAspectRatio<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>mVideoView<span class="token punctuation">.</span><span class="token function">getDisplayAspectRatio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> PLVideoTextureView<span class="token punctuation">.</span>ASPECT_RATIO_ORIGIN<span class="token operator">:</span>
                <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"Origin mode"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> PLVideoTextureView<span class="token punctuation">.</span>ASPECT_RATIO_FIT_PARENT<span class="token operator">:</span>
                <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"Fit parent !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> PLVideoTextureView<span class="token punctuation">.</span>ASPECT_RATIO_PAVED_PARENT<span class="token operator">:</span>
                <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"Paved parent !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> PLVideoTextureView<span class="token punctuation">.</span>ASPECT_RATIO_16_9<span class="token operator">:</span>
                <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"16 : 9 !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> PLVideoTextureView<span class="token punctuation">.</span>ASPECT_RATIO_4_3<span class="token operator">:</span>
                <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"4 : 3 !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> PLMediaPlayer<span class="token punctuation">.</span>OnErrorListener mOnErrorListener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PLMediaPlayer<span class="token punctuation">.</span>OnErrorListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onError</span><span class="token punctuation">(</span>PLMediaPlayer mp<span class="token punctuation">,</span> <span class="token keyword">int</span> errorCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">switch</span> <span class="token punctuation">(</span>errorCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>ERROR_CODE_INVALID_URI<span class="token operator">:</span>
                    <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"Invalid URL !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>ERROR_CODE_404_NOT_FOUND<span class="token operator">:</span>
                    <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"404 resource not found !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>ERROR_CODE_CONNECTION_REFUSED<span class="token operator">:</span>
                    <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"Connection refused !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>ERROR_CODE_CONNECTION_TIMEOUT<span class="token operator">:</span>
                    <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"Connection timeout !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>ERROR_CODE_EMPTY_PLAYLIST<span class="token operator">:</span>
                    <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"Empty playlist !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>ERROR_CODE_STREAM_DISCONNECTED<span class="token operator">:</span>
                    <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"Stream disconnected !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>ERROR_CODE_IO_ERROR<span class="token operator">:</span>
                    <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"Network IO Error !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>ERROR_CODE_UNAUTHORIZED<span class="token operator">:</span>
                    <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"Unauthorized Error !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>ERROR_CODE_PREPARE_TIMEOUT<span class="token operator">:</span>
                    <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"Prepare timeout !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>ERROR_CODE_READ_FRAME_TIMEOUT<span class="token operator">:</span>
                    <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"Read frame timeout !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>MEDIA_ERROR_UNKNOWN<span class="token operator">:</span>
                <span class="token keyword">default</span><span class="token operator">:</span>
                    <span class="token function">showToastTips</span><span class="token punctuation">(</span><span class="token string">"unknown error !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment" spellcheck="true">// Todo pls handle the error status here, retry or call finish()</span>
            <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// If you want to retry, do like this:</span>
            <span class="token comment" spellcheck="true">// mVideoView.setVideoPath(mVideoPath);</span>
            <span class="token comment" spellcheck="true">// mVideoView.start();</span>
            <span class="token comment" spellcheck="true">// Return true means the error has been handled</span>
            <span class="token comment" spellcheck="true">// If return false, then `onCompletion` will be called</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>


     <span class="token keyword">private</span> PLMediaPlayer<span class="token punctuation">.</span>OnCompletionListener mOnCompletionListener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PLMediaPlayer<span class="token punctuation">.</span>OnCompletionListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCompletion</span><span class="token punctuation">(</span>PLMediaPlayer plMediaPlayer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment" spellcheck="true">//            finish();</span>
            <span class="token function">showToast</span><span class="token punctuation">(</span><span class="token string">"视频播放完成"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> PLMediaPlayer<span class="token punctuation">.</span>OnBufferingUpdateListener mOnBufferingUpdateListener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PLMediaPlayer<span class="token punctuation">.</span>OnBufferingUpdateListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onBufferingUpdate</span><span class="token punctuation">(</span>PLMediaPlayer plMediaPlayer<span class="token punctuation">,</span> <span class="token keyword">int</span> precent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> PLMediaPlayer<span class="token punctuation">.</span>OnSeekCompleteListener mOnSeekCompleteListener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PLMediaPlayer<span class="token punctuation">.</span>OnSeekCompleteListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onSeekComplete</span><span class="token punctuation">(</span>PLMediaPlayer plMediaPlayer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Logger<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"onSeekComplete !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> PLMediaPlayer<span class="token punctuation">.</span>OnPreparedListener mOnPreparedListener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PLMediaPlayer<span class="token punctuation">.</span>OnPreparedListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onPrepared</span><span class="token punctuation">(</span>PLMediaPlayer plMediaPlayer<span class="token punctuation">)</span> <span class="token punctuation">{</span>


        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> PLMediaPlayer<span class="token punctuation">.</span>OnInfoListener mOnInfoListener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PLMediaPlayer<span class="token punctuation">.</span>OnInfoListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onInfo</span><span class="token punctuation">(</span>PLMediaPlayer plMediaPlayer<span class="token punctuation">,</span> <span class="token keyword">int</span> what<span class="token punctuation">,</span> <span class="token keyword">int</span> extra<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">switch</span> <span class="token punctuation">(</span>what<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>MEDIA_INFO_BUFFERING_START<span class="token operator">:</span>
                    Logger<span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">"正在缓冲----"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">//开始缓存，暂停播放</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isPlaying</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment" spellcheck="true">//                        stopPlayer();</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>mVideoView <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            mVideoView<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        needResume <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    rl_loading<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>VISIBLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>MEDIA_INFO_BUFFERING_END<span class="token operator">:</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>MEDIA_INFO_VIDEO_RENDERING_START<span class="token operator">:</span>
                    Logger<span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">"缓冲完成----"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">//缓存完成，继续播放</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>needResume<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">//                        startPlayer();</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>mVideoView <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            mVideoView<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    rl_loading<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>GONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>MEDIA_INFO_BUFFERING_BYTES_UPDATE<span class="token operator">:</span>
                    <span class="token comment" spellcheck="true">//显示 下载速度</span>
                    Logger<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">"download rate:"</span> <span class="token operator">+</span> extra<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">//mListener.onDownloadRateChanged(arg2);</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            Logger<span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">"onInfo:"</span> <span class="token operator">+</span> what <span class="token operator">+</span> <span class="token string">"___"</span> <span class="token operator">+</span> extra<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>这样就完成了普通视频的播放和旋转视频播放</p>
<p>看似简单 其实隐藏着大问题 ，也就是我所说的大坑<br>现在我是这样判断角度的  当视频的宽度大于高度的 我就认为这是一个横屏的视频 ，也就是说假如这个视频是1330X720（我随便说的尺寸，只为举例）现在宽度大于高度了 那么这就是一个横屏的视频，但是我只要播放手机拍摄的视频就会发现视频被放大了 ，但是其实我录制视频的时候是竖着排的 ，可视播放的时候却给我横着过来了，然后我就去看这个手机拍摄视频的尺寸  现在一般录制视频最低都是1280X720  ，恰好符合我判断的逻辑 ，难道他真是横着的？  然后我就用系统自带的播放器打开 ，居然没有横过来 ，而是竖着播放的 ，可它是怎么知道这个方向呢？于是我在百度搜 ，确实可以获取到本地视频的角度，但是好像低版本好像不兼容，然后根据角度去判断 是否需要旋转，可是我这个是网络视频啊  ，网络视频怎么获取到视频角度啊 ？ 我第一反应是 上传视频的时候把宽高角度传到服务器 ，然后获取的时候根据这个角度旋转 ，但是别人播放网络视频的时候也没有传角度过去啊 - -  然后我就在github上面问那个作者  ，结果他说 </p>
<p><strong>“onInfo: 10001, 90”, 收到这个消息后，使用 PLVideoTextureView 的 setDisplayOrientation 旋转显示的方向，后面会补充这个回调的接口和文档。</strong></p>
<p>我晕  ，你这不说 谁知道啊 坑死啊 -  -<br>然后我就修改了下代码</p>
<pre class=" language-java"><code class="language-java"> <span class="token comment" spellcheck="true">/**
     * 视频的方向
     */</span>
<span class="token keyword">private</span> <span class="token keyword">int</span> mVideoRotation<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> needResume<span class="token punctuation">;</span>
    <span class="token keyword">private</span> PLMediaPlayer<span class="token punctuation">.</span>OnInfoListener mOnInfoListener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PLMediaPlayer<span class="token punctuation">.</span>OnInfoListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onInfo</span><span class="token punctuation">(</span>PLMediaPlayer plMediaPlayer<span class="token punctuation">,</span> <span class="token keyword">int</span> what<span class="token punctuation">,</span> <span class="token keyword">int</span> extra<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">switch</span> <span class="token punctuation">(</span>what<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>MEDIA_INFO_BUFFERING_START<span class="token operator">:</span>
                    Logger<span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">"正在缓冲----"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">//开始缓存，暂停播放</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isPlaying</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment" spellcheck="true">//                        stopPlayer();</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>mVideoView <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            mVideoView<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        needResume <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    rl_loading<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>VISIBLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>MEDIA_INFO_BUFFERING_END<span class="token operator">:</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>MEDIA_INFO_VIDEO_RENDERING_START<span class="token operator">:</span>
                    Logger<span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">"缓冲完成----"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">//缓存完成，继续播放</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>needResume<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">//                        startPlayer();</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>mVideoView <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            mVideoView<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    rl_loading<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>GONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> PLMediaPlayer<span class="token punctuation">.</span>MEDIA_INFO_BUFFERING_BYTES_UPDATE<span class="token operator">:</span>
                    <span class="token comment" spellcheck="true">//显示 下载速度</span>
                    Logger<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">"download rate:"</span> <span class="token operator">+</span> extra<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">//mListener.onDownloadRateChanged(arg2);</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">10001</span><span class="token operator">:</span>
                    <span class="token comment" spellcheck="true">//保存视频角度</span>
                    mVideoRotation<span class="token operator">=</span>extra<span class="token punctuation">;</span>

                    <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            Logger<span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">"onInfo:"</span> <span class="token operator">+</span> what <span class="token operator">+</span> <span class="token string">"___"</span> <span class="token operator">+</span> extra<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>然后在onVideoSizeChanged的回调里这样</p>
<pre class=" language-java"><code class="language-java"> mVideoView<span class="token punctuation">.</span><span class="token function">setOnVideoSizeChangedListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PLMediaPlayer<span class="token punctuation">.</span>OnVideoSizeChangedListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onVideoSizeChanged</span><span class="token punctuation">(</span>PLMediaPlayer plMediaPlayer<span class="token punctuation">,</span> <span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                Logger<span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">"width:"</span> <span class="token operator">+</span> width <span class="token operator">+</span> <span class="token string">"---heightL:"</span> <span class="token operator">+</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>width <span class="token operator">></span> height<span class="token operator">&amp;&amp;</span>mVideoRotation<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">//旋转方向</span>
                    <span class="token function">setRequestedOrientation</span><span class="token punctuation">(</span>ActivityInfo<span class="token punctuation">.</span>SCREEN_ORIENTATION_LANDSCAPE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment" spellcheck="true">//如果视频角度是90度</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>mVideoRotation<span class="token operator">==</span><span class="token number">90</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                   <span class="token comment" spellcheck="true">//旋转视频</span>
                    mVideoView<span class="token punctuation">.</span><span class="token function">setDisplayOrientation</span><span class="token punctuation">(</span><span class="token number">270</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>这样 不管是什么视频  播放终于正常了  - -  </p>
<p>转载请注明出处  <a href="http://blog.csdn.net/yewei02538/article/details/51882933" target="_blank" rel="external">http://blog.csdn.net/yewei02538/article/details/51882933</a></p>
<p>Demo下载地址: <a href="http://download.csdn.net/detail/yewei02538/9602032" target="_blank" rel="external">http://download.csdn.net/detail/yewei02538/9602032</a></p>

	
	
	
	
</div>
				
				

                <!-- Post Comments -->
                
                    




    <!-- 使用云跟帖评论 -->
    <link rel="stylesheet" href="/css/duoshuo.min.css">
<div id="comments">
<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2129330"></script>
<!-- UY END -->
</div>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    
    <!-- Prev Nav -->
    
        <a href="/detail/dialogactivity/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/detail/commit-onCreateView/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>
        </div>
    </div>

				
				
					<!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay "></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored  sidebar-fixed-left" role="navigation">
	<div id="sidebar-main">
	    <!-- Sidebar Header -->
		<div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
    <i class="material-icons">clear_all</i>
    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.jpg" alt="Wey Ye's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        hiweyye@gmail.com
        <b class="caret"></b>
    </a>
</div>

		<!-- Sidebar Navigation  -->
		<ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
			
                <li>
                    <a href="#" target="_blank" title="Email Me">
						<i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
             主页
        </a>
    </li>

    <!-- I'm Feeling Lucky -->
<!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
-->

	
    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/02/">二月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/12/">十二月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/08/">八月 2016<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/02/">二月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/11/">十一月 2015<span class="sidebar_archives-count">1</span></a>
        </ul>
    </li>

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
	
		<li>
			<a href="https://github.com/yewei02538" title="github">
				github
			</a>
		</li>
	
		<li>
			<a href="/about" title="关于我">
				关于我
			</a>
		</li>
	

    <!-- Article Numebr  -->
    <li>
        <a href="/archives">
             文章总数
             <span class="sidebar-badge">16</span>
        </a>
    </li>
</ul>

		<!-- Sidebar Divider -->
		<div class="sidebar-divider"></div>

		<!-- Sidebar Footer -->
		<!-- 
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持。 :) 
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
	<div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		主题 - Material
		<span class="sidebar-badge badge-circle">i</span>
	</div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		sidebar.help
		<span class="mdl-button__ripple-container">
			<span class="mdl-ripple"></span>
		</span>
	</div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

	</div>
    
    <!-- Sidebar Sponsor -->
    


</aside>

				
				
				
					<!-- Footer Top Button -->
					<div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>
				
				
				<!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
	
	
		<!-- Paradox Footer Left Section -->
		<div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
    

    <!-- Facebook -->
    
    

    <!-- Google + -->
    
    

    <!-- Weibo -->
    
    

    <!-- Instagram -->
    
    

    <!-- Tumblr -->
    
    

    <!-- Github -->
    
    <a href="https://github.com/yewei02538" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
        <span class="visuallyhidden">Github</span>
    </button></a>
    

    <!-- LinkedIn -->
    
    
</div>


		<!--Copyright-->
		<div id="copyright">Copyright&nbsp;©&nbsp;<script type="text/javascript">var fd = new Date();document.write(fd.getFullYear());</script>&nbsp;Wey Ye的博客</div>

		<!-- Paradox Footer Right Section -->

		<!-- 
		I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright.
		It will not impact the appearance and can give developers a lot of support :)

		很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
		它不会影响美观并可以给开发者很大的支持。 :) 
		-->

		<div class="mdl-mini-footer--right-section">
			<div>
				<div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
				<div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
			</div>
		</div>
	
    
</footer>
                
				<!-- Import File -->
<script src="/js/highlight.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    
    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });
    
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>




    <!-- Leancloud -->
	<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
	<script>
		AV.initialize("GcHXwHPjgI0bDNKzduO1nOvv-gzGzoHsz", "k3SkcOk8UqsaDyJzdPRAybv8");
	</script>
    <script>
	function showTime(Counter) {
		var query = new AV.Query(Counter);
		$(".leancloud-views_num").each(function() {
			var url = $(this).attr("id").trim();
			query.equalTo("url", url);
			query.find({
				success: function(results) {
					if (results.length == 0) {
						var content = '0 ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
						return;
					}
					for (var i = 0; i < results.length; i++) {
						var object = results[i];
						var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
					}
				},
				error: function(object, error) {
					console.log("Error: " + error.code + " " + error.message);
				}
			});

		});
	}

	function addCount(Counter) {
		var Counter = AV.Object.extend("Counter");
		url = $(".leancloud-views_num").attr('id').trim();
		title = $(".leancloud-views_num").attr('data-flag-title').trim();
		var query = new AV.Query(Counter);
		query.equalTo("url", url);
		query.find({
			success: function(results) {
				if (results.length > 0) {
					var counter = results[0];
					counter.fetchWhenSave(true);
					counter.increment("time");
					counter.save(null, {
						success: function(counter) {
							var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
							$(document.getElementById(url)).text(content);
						},
						error: function(counter, error) {
							console.log('Failed to save Visitor num, with error message: ' + error.message);
						}
					});
				} else {
					var newcounter = new Counter();
					newcounter.set("title", title);
					newcounter.set("url", url);
					newcounter.set("time", 1);
					newcounter.save(null, {
						success: function(newcounter) {
							console.log("newcounter.get('time')="+newcounter.get('time'));
							var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
							$(document.getElementById(url)).text(content);
						},
						error: function(newcounter, error) {
							console.log('Failed to create');
						}
					});
				}
			},
			error: function(error) {
				console.log('Error:' + error.code + " " + error.message);
			}
		});
	}
	$(function() {
		var Counter = AV.Object.extend("Counter");
		if ($('.leancloud-views_num').length == 1) {
			addCount(Counter);
		} else if ($('.post-title-link').length > 1) {
			showTime(Counter);
		}
	}); 
</script>








<!-- Swiftye -->


<!-- Local Search-->

	<script>
	var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        success: function( xmlResponse ) {
            // get the contents from search data
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length <= 0) {
                    return;
                }
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        str += "<li><a href='"+ data_url +"' class='search-result-title' target='_blank'>"+ data_title;
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out characters
                            var start = first_occur - 6;
                            var end = first_occur + 6;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 10;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substr(start, end); 
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<em class=\"search-keyword\">"+keyword+"</em>");
                            })
                            str += "<p class=\"search-result\">" + match_content +"...</p>" +"</a>";
                        }
                    }
                })
                $resultContent.innerHTML = str;
            })
        }
    })
}
</script>

	<script>
        var inputArea = document.querySelector("#search");
        var getSearchFile = function(){
            var path = "search.xml";
            searchFunc(path, 'search', 'local-search-result');
        }

        inputArea.onfocus = function(){ getSearchFile() }
	</script>


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $(".post-toc-wrap").parent(".mdl-menu__container").css("position", "fixed");
    });
</script>

<!-- MathJax Load-->

            </main>
        </div>
		
    </body>
		
	
</html>
